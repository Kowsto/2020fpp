<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Download manual button-->
    <template inherit_id='website_sale.product' id="product_manual_pdf_name" customize_show="True" name="Image Zoom">
        <xpath expr="//a[@id='add_to_cart']" position='after'>
            <t t-if="product_variant.manual_pdf">
                <div>
                    <a role="button" class="btn btn-primary btn-lg mt8 js_check_product" t-att-href="'/shop/product/download_manual/%s' % (product_variant.id) ">Download Manual</a>
                </div>
            </t>
        </xpath>
    </template>

    <!-- Remove shopping cart-->
    <template inherit_id='website_sale.products_add_to_cart' id="product_remove_shopping_cart" customize_show="True" name="Image Zoom">
        <xpath expr="//a[@class='btn btn-secondary btn-sm a-submit']" position='attributes'>
            <attribute name="t-if">not lowest_categories</attribute>
        </xpath>
    </template>

    <!-- Remove shopping cart-->
    <template inherit_id='website_sale.products_item' id="product_remove_price" customize_show="True" name="Image Zoom">
        <xpath expr="//a[@itemprop='name']" position='after'>
            <a itemprop="name" t-att-href="'/shop/category/%s' %slug(product.public_categ_ids)" t-att-content="product.name" t-field="product.public_categ_ids.name" t-if="lowest_categories and not category" />
            <a itemprop="name" t-att-href="'/shop/product/%s' %slug(product)" t-att-content="product.name" t-field="product.name" t-if="lowest_categories and category" />
        </xpath>
        <xpath expr="//a[@itemprop='url']" position='replace'>
            <a itemprop="url" t-att-href="'/shop/category/%s' %slug(product.public_categ_ids)" t-if="lowest_categories and not category">
                <span t-field="product.image" t-options="{'widget': 'image', 'resize': None if product_image_big else '300x300'}"/>
            </a>
            <a itemprop="url" t-att-href="product_href" t-if="lowest_categories and category">
                <span t-field="product.image" t-options="{'widget': 'image', 'resize': None if product_image_big else '300x300'}"/>
            </a>
        </xpath>
        <xpath expr="//a[@itemprop='name']" position='attributes'>
            <attribute name="t-if">not lowest_categories</attribute>
        </xpath>
        <xpath expr="//a[@class='btn btn-secondary btn-sm btn-danger']" position='attributes'>
            <attribute name="t-if">not lowest_categories or category</attribute>
        </xpath>
        <xpath expr="//div[@class='product_price']" position='attributes'>
            <attribute name="t-if">not lowest_categories or category</attribute>
        </xpath>
    </template>

    <!-- link for categories-->
    <template inherit_id='website_sale.suggested_products_list' id="product_change_link" customize_show="True" name="Link to categories from image">
        <xpath expr="//a[@t-attf-href='/shop/product/#{ slug(product.product_tmpl_id) }']" position='replace'>
            <a t-attf-href="'/shop/category/%s' %slug(product.public_categ_ids)" t-if="lowest_categories and not category">
                <span t-field="product.image_small" t-options="{'widget': 'image', 'class': 'rounded'}" />
            </a>
            <a t-attf-href="/shop/product/%s' %slug(product)" t-if="lowest_categories and category">
                <span t-field="product.image_small" t-options="{'widget': 'image', 'class': 'rounded'}" />
            </a>
        </xpath>
        <xpath expr="//td[@class='td-product_name']" position='replace'>
            <td class='td-product_name'>
                <div>
                    <a t-attf-href="'/shop/category/%s' %slug(product.public_categ_ids)">
                        <strong t-esc="combination_info['display_name']" />
                    </a>
                </div>
                <div class="text-muted d-none d-md-block" t-field="product.description_sale" />
            </td>
        </xpath>
    </template>

     <!-- /shop product listing -->
    <template id="product_list" name="Product List">
        <t t-call="website.layout">
            <t t-set="additional_title">Product List</t>
            <div id="wrap" class="js_sale">
                <div class="oe_structure" id="oe_structure_website_sale_products_1"/>
                <div class="container py-2 oe_website_sale">
                    <div class="products_pager form-inline justify-content-center">
                        <t t-call="website_sale.search">
                            <t t-set="_classes">o_website_sale_search</t>
                        </t>
                        <t t-call="website_sale.pricelist_list">
                            <t t-set="_classes">ml-2</t>
                        </t>
                        <t t-call="website.pager">
                            <t t-set="_classes">ml-2</t>
                        </t>
                    </div>

                    <t t-foreach="products" t-as="product">
                        <div class="oe_product oe_list oe_product_cart"
                             t-att-data-publish="product.website_published and 'on' or 'off'">
                            <t t-call="website_sale.products_item">
                                <t t-set="show_publish" t-value="True" t-att-content="product.name"/>
                            </t>
                        </div>
                    </t>

                    <div class="row mt-3">
                        <div class="d-none" id="products_grid_before"></div>
                        <ul class="nav nav-pills flex-column mt16">
                            <li class="nav-item">
                                <a t-att-href="keep('/shop',category=0)"
                                   t-attf-class="nav-link#{'' if category else ' active'} o_not_editable">All Products
                                </a>
                            </li>
                            <t t-foreach="categories" t-as="c">
                                <t t-call="website_sale.categories_recursive"/>
                            </t>
                        </ul>
                    </div>
                    <div class="products_pager form-inline justify-content-center mt-3">
                        <t t-call="website.pager"/>
                    </div>
                </div>
                <div class="oe_structure mb32" id="oe_structure_website_sale_products_2"/>
            </div>
        </t>
    </template>

</odoo>
